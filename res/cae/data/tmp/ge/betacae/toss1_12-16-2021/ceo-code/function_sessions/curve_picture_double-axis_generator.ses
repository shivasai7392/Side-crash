$-- CURVE PICTURE TAKING SESSION: EXAMPLE VARIABLES
$

opt var add og_target_window ${target_window}

$-- FUNCTION START --$
xyplot create ${tmp_window}
window active ${tmp_window}
xyplot rlayout "${tmp_window}" 1
window size ${picture_size}
window active none

opt var add total_curves ${target_curves}


window active "${picture_window}"
xyplot plotactive "${picture_window}" all
xyplot curve deselect "${picture_window}" all
xyplot curve select "${picture_window}" ${total_curves}
xyplot curve copy "${picture_window}" selected
window active ${tmp_window}
xyplot curve paste "${tmp_window}" 0 selected

opt var add target_window ${tmp_window}

opt var add target_variable y0_curves
read session ${pptx_source_path}/function_sessions/curve_string_generator.ses
opt var add parsed_y0_curves ${target_curves}

xyplot curve set assign yaxis ${tmp_window} ${parsed_y0_curves} 0

opt var add target_variable y1_curves
read session ${pptx_source_path}/function_sessions/curve_string_generator.ses
opt var add parsed_y1_curves ${target_curves}

xyplot curve set assign yaxis ${tmp_window} ${parsed_y1_curves} 1

opt var add target_window ${og_target_window}

xyplot axisoptions yaxis active "${tmp_window}" 0 0
xyplot axisoptions yaxis showaxis "${tmp_window}" 0 0
xyplot axisoptions yaxis active "${tmp_window}" 0 1
xyplot axisoptions yaxis showaxis "${tmp_window}" ${parsed_y1_curves} 1
window active ${picture_window}
xyplot plotactive "${picture_window}" all
xyplot curve deselect "${picture_window}" all
xyplot plotdeactive "${picture_window}" all
window active "${tmp_window}"
xyplot plotactive "${tmp_window}" 0
xyplot plotoptions legend off "${tmp_window}" 0
options title off

opt var add formatting_window_name_og ${formatting_window_name}
opt var add window_number_og ${window_number}

$-- FORMATTING

opt var add formatting_window_name "${tmp_window}"
opt var add window_number 0

$-- GENERAL
xyplot plotactive "${formatting_window_name}" ${window_number}
xyplot curve visible all "${formatting_window_name}"
xyplot plotoptions title set "${formatting_window_name}" ${window_number} "${title_label}"
xyplot plotoptions title font "${formatting_window_name}" all "${font_info}"
$-- Y0
xyplot axisoptions yaxis active "${formatting_window_name}" ${window_number} 0
xyplot axisoptions yaxis multiplier on "${formatting_window_name}"
xyplot axisoptions ylabel font "${formatting_window_name}" all "${font_info}"
xyplot axisoptions labels yfont "${formatting_window_name}" all "${font_info}"
xyplot axisoptions yaxis multiplier set "${formatting_window_name}" ${y0_multiplier}
xyplot axisoptions yshowmultiplier off "${formatting_window_name}" ${window_number}
xyplot axisoptions ylocktitle off "${formatting_window_name}" ${window_number}
xyplot axisoptions ylabel set "${formatting_window_name}" ${window_number} "${y0_label}"
xyplot axisoptions ylocktitle on "${formatting_window_name}" ${window_number}
xyplot axisoptions ylockvalues off "${formatting_window_name}" ${window_number}
xyplot axisoptions axyrange "${formatting_window_name}" ${window_number} 0 ${y0_min} ${y0_max}
xyplot axisoptions ylockvalues on "${formatting_window_name}" ${window_number}
xyplot gridoptions yspace "${formatting_window_name}" ${window_number} ${y0_step}
xyplot axisoptions yaxis deactive "${formatting_window_name}" ${window_number} 0
$-- Y1
xyplot axisoptions yaxis active "${formatting_window_name}" ${window_number} 1
xyplot axisoptions yaxis multiplier on "${formatting_window_name}"
xyplot axisoptions ylabel font "${formatting_window_name}" all "${font_info}"
xyplot axisoptions labels yfont "${formatting_window_name}" all "${font_info}"
xyplot axisoptions yaxis multiplier set "${formatting_window_name}" ${y1_multiplier}
xyplot axisoptions yshowmultiplier off "${formatting_window_name}" ${window_number}
xyplot axisoptions ylocktitle off "${formatting_window_name}" ${window_number}
xyplot axisoptions ylabel set "${formatting_window_name}" ${window_number} "${y1_label}"
xyplot axisoptions ylocktitle on "${formatting_window_name}" ${window_number}
xyplot axisoptions ylockvalues off "${formatting_window_name}" ${window_number}
xyplot axisoptions axyrange "${formatting_window_name}" ${window_number} 1 ${y1_min} ${y1_max}
xyplot axisoptions ylockvalues on "${formatting_window_name}" ${window_number}
xyplot gridoptions yspace "${formatting_window_name}" ${window_number} ${y1_step}
xyplot axisoptions yaxis deactive "${formatting_window_name}" ${window_number} 1
$-- X0
xyplot axisoptions xaxis active "${formatting_window_name}" ${window_number} 0
xyplot axisoptions xlabel font "${formatting_window_name}" all "${font_info}"
xyplot axisoptions labels xfont "${formatting_window_name}" all "${font_info}"
xyplot gridoptions xspace "${formatting_window_name}" ${window_number} ${x_space}
xyplot axisoptions xspacelock on "${formatting_window_name}" ${window_number}
xyplot axisoptions xaxis multiplier on "${formatting_window_name}"
xyplot axisoptions xaxis multiplier set "${formatting_window_name}" ${x_multiplier}
xyplot axisoptions xshowmultiplier off "${formatting_window_name}" ${window_number}
xyplot axisoptions xlabel set "${formatting_window_name}" ${window_number} "${x_label}"
xyplot axisoptions axxrange "${formatting_window_name}" ${window_number} 0 ${x_min} ${x_max}
xyplot axisoptions xlockvalues on "${formatting_window_name}" ${window_number}
xyplot axisoptions xspacelock on "${formatting_window_name}" ${window_number}
xyplot axisoptions xaxis deactive "${formatting_window_name}" ${window_number} 0
xyplot curve visible not "${formatting_window_name}" all
xyplot plotdeactive "${formatting_window_name}" ${window_number}

opt var add formatting_window_name ${formatting_window_name_og}
opt var add window_number ${window_number_og}

$-- MAKE THE DATA VISIBLE AND TURN OFF SYNC TO TIME
xyplot plotactive "${tmp_window}" 0
xyplot curve visible all "${tmp_window}"
xyplot curve select "${tmp_window}" all
xyplot curve set sync axis "${tmp_window}" selected none
xyplot plotdeactive "${tmp_window}" 0

$-- OUTPUT NON-LABELLED PICTURE

xyplot plotactive "${tmp_window}" 0
xyplot plotoptions title show off "${tmp_window}" 0
xyplot plotdeactive "${tmp_window}" 0

write options outputsize specify ${picture_size}
write options savebg enable
write options transparent enable
write options outputsize dpi ${dpi}
write options scalefonts enable
write options scalefonts 1 100
write options scalefonts 100 100
write options scalefonts disable
write jpeg "${run_directory}/Session_Report/${picture_window}_${file_name}.jpeg" 100

$-- OUTPUT TITLE PICTURE

xyplot plotactive "${tmp_window}" 0
xyplot plotoptions title show on "${tmp_window}" 0
xyplot plotdeactive "${tmp_window}" 0

write options outputsize specify ${picture_size}
write options savebg enable
write options transparent enable
write options outputsize dpi ${dpi}
write options scalefonts enable
write options scalefonts 1 100
write options scalefonts 100 100
write options scalefonts disable
write jpeg "${run_directory}/Session_Report/${picture_window}_${file_name}_TITLED.jpeg" 100

$-- OUTPUT LEGEND PICTURE

xyplot plotactive "${tmp_window}" 0
xyplot plotoptions legend on "${tmp_window}" 0
xyplot plotdeactive "${tmp_window}" 0

write options outputsize specify ${picture_size}
write options savebg enable
write options transparent enable
write options outputsize dpi ${dpi}
write options scalefonts enable
write options scalefonts 1 100
write options scalefonts 100 100
write options scalefonts disable
write jpeg "${run_directory}/Session_Report/${picture_window}_${file_name}_LEGEND.jpeg" 100

window delete "${tmp_window}"

//#!python
# PYTHON script
import meta
import os
from meta import *

def main():

	run_dir = str(utils.MetaGetVariable('run_directory'))
	image_size = str(utils.MetaGetVariable('picture_size'))
	print("OUTPUT IMAGE SIZE (PIXELS) : "+str(image_size))
	picture_window = str(utils.MetaGetVariable('picture_window'))
	file_name = str(utils.MetaGetVariable('file_name'))
	output1 = os.path.join(run_dir,"pptx_report",picture_window+"_"+file_name+".jpeg")
	output2 = os.path.join(run_dir,"pptx_report",picture_window+"_"+file_name+"_TITLED.jpeg")
	output3 = os.path.join(run_dir,"pptx_report",picture_window+"_"+file_name+"_LEGEND.jpeg")
	print("OUTPUT CURVE IMAGES : ")
	print(output1)
	print(output2)
	print(output3)
	print("")

if __name__ == '__main__':
	main()
//#!EOF
